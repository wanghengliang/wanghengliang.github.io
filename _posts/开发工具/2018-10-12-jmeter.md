---
layout: post
title: jmeter压力测试
date: 2018-10-12
categories: 开发工具
tags: 压力测试
---
jmeter压力测试

### 下载及安装

1. 登录官网Jmeter下载，得到压缩包apache-jmeter-5.0.tgz，下载地址：http://jmeter.apache.org/download_jmeter.cgi
2. 将下载得到的压缩包apache-jmeter-5.0.tgz解压即可。
![](/images/posts/tools/jmeter01.png)

### 运行

执行bin/jmeter.bat或者bin/jmeter.sh运行，效果图如下
![](/images/posts/tools/jmeter02.png)

### 一个简单的压测实例

#### 新建一个线程组
![](/images/posts/tools/jmeter03.png)

#### 设置线程组参数
这里配置为：10个线程，同时启动，循环一次。这些配置元件用于指定运行的线程数和等候周期。每个线程模拟一个用户，而等候周期用于指定创建全部线程的时间。例如，线程数为5，等候时间为10秒，则创建每个线程之间的时间间隔为2秒。循环数定义了线程的运行时间。使用调度器，还可以设置运行的起始时间。
![](/images/posts/tools/jmeter04.png)

#### 新增http请求默认值
在上一步创建的线程组上，新增http请求默认值，所有的请求都会使用设置的默认值，这设置协议为http，IP为127.0.0.1，端口为8080
![](/images/posts/tools/jmeter05.png)
![](/images/posts/tools/jmeter06.png)

#### 添加要压测的http请求
![](/images/posts/tools/jmeter07.png)
下图第一个红框内的协议、IP、端口不需要设置，会使用步骤c中设置的默认值，只需设置请求路径Path即可，这里填入/index.html
![](/images/posts/tools/jmeter08.png)

#### 新增监听器，用于查看压测结果
这里添加三种：聚合报告、图形结果、用表格查看结果，区别在于结果展现形式不同。
![](/images/posts/tools/jmeter09.png)

#### 点击运行按钮开始压测，并查看结果
![](/images/posts/tools/jmeter10.png)

### jmeter结果分析
采用Jmeter测试工具对web系统作的负载测试，得出的响应报表，数据比较难懂，现作一具体说明。

#### 图形报表
![](/images/posts/tools/jmeter11.png)

图表底部参数的含义如下：
1. 样本数目是总共发送到服务器的请求数。
2. 最新样本是代表时间的数字,是服务器响应最后一个请求的时间。
3. 吞吐量是服务器每分钟处理的请求数。 
4. 平均值是总运行时间除以发送到服务器的请求数。 
5. 中间值是代表时间的数字，有一半的服务器响应时间低于该值而另一半高于该值。 
6. 偏离表示服务器响应时间变化、离散程度测量值的大小，或者，换句话说，就是数据的分布。

#### 聚合报告
![](/images/posts/tools/jmeter12.png)
图表含义说明如下：
1. Label：说明是请求类型，如Http，FTP等请求。
2. #Samples：也就是图形报表中的样本数目，总共发送到服务器的样本数目。
3. Average：也就是图形报表中的平均值，是总运行时间除以发送到服务器的请求数。
4. Median：也就是图形报表中的中间值，是代表时间的数字，有一半的服务器响应时间低于该值而另一半高于该值。
5. 90%line：是指90%请求的响应时间比所得数值还要小。
6. Min：是代表时间的数字,是服务器响应的最短时间。
7. Max: 是代表时间的数字,是服务器响应的最长时间。
8. Error%:请求的错误百分比。
9. Throughput:也就是图形报表中的吞吐量，这里是服务器每单位时间处理的请求数，注意查看是秒或是分钟。
10. Received KB/sec 是每秒钟接收的字节数。
11. Send KB/sec:是每秒钟请求的字节数。

图中配置的所有数据写入文件test-jh.jtl，可通过命令模式将其数据生成html文档，命令如下：

```
# cd apache-jmeter-5.0
# bin/jmeter.sh -g report/test-jh.jtl -e -o report/test
```
生成结果图片如下：
![](/images/posts/tools/jmeter13.png)



### 附：Jmeter命令行参数
![](/images/posts/tools/jmeter_ps01.png)

