<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>hengliang</title>
    <description>快乐地创造和品味生活</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Fri, 03 Aug 2018 12:01:05 +0800</pubDate>
    <lastBuildDate>Fri, 03 Aug 2018 12:01:05 +0800</lastBuildDate>
    <generator>Jekyll v3.5.2</generator>
    
      <item>
        <title>MySQL调试技巧</title>
        <description>&lt;p&gt;MySQL调试技巧&lt;/p&gt;

&lt;h3 id=&quot;mysql查询最近执行sql&quot;&gt;MySQL查询最近执行SQL&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;进入MySQL,略&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;启用Log功能&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 查询是否启用Log功能
mysql&amp;gt; SHOW VARIABLES LIKE &quot;general_log%&quot;;
+--------------------+--------------------------------------------------+
| Variable_name      |    Value                                         |
+--------------------+--------------------------------------------------+
| general_log        | OFF                                              |
| general_log_file   | /usr/local/mysql/data/MacBook-Pro.log            |
+--------------------+--------------------------------------------------+
# 启用Log功能
mysql&amp;gt; SET GLOBAL general_log = 'ON';

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ol&gt;
  &lt;li&gt;设置Log文件地址(所有Sql语句都会在general_log_file里)，采用默认则不设置&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql&amp;gt; SET GLOBAL general_log_file = 'c:\mysql.log';
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;执行mysql命令然后查看设置的Log文件，也可用其他可视化工具进行查看。&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Thu, 19 Jul 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/07/mysql_debug/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/mysql_debug/</guid>
        
        <category>数据库</category>
        
        <category>MySQL</category>
        
        
        <category>数据库</category>
        
      </item>
    
      <item>
        <title>MySQL备份</title>
        <description>&lt;p&gt;MySQL备份&lt;/p&gt;

&lt;h3 id=&quot;mysql-导出excel方法&quot;&gt;mysql 导出excel方法&lt;/h3&gt;
&lt;p&gt;1.执行如下命令，可将执行结果导出到excel中：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql iptv_pet -uroot -p -e &quot;call SP_PET_STATISTICS(1)&quot; &amp;gt; /data/tj_20160819.xls
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql iptv_pet -uroot -p -e &quot;select user_id,code ,create_time from tbl_statistics_order where code like '%result_0' and TO_DAYS(NOW())-TO_DAYS(CREATE_TIME) = 1 order by create_time desc &quot; &amp;gt; /data/order_tj_20160822.xls
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;2.因为office默认的是gb2312编码，服务器端生成的很有可能是utf-8编码，采用如下命令可将其转换为gb2312编码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;iconv -futf8 -tgb2312 -otj_20160819_gb2312.xls tj_20160819.xls
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;shell脚本如下：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;date +%Y%m%d&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
mysql iptv_pet -uroot -p&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt; -e &lt;span class=&quot;s2&quot;&gt;&quot;call SP_PET_STATISTICS(1)&quot;&lt;/span&gt; &amp;gt; /data/backup/tj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;.xls
&lt;span class=&quot;c&quot;&gt;#mysql iptv_pet -uroot -p****** -e &quot;select user_id,code ,create_time from tbl_statistics_order where code like '%result_0' and TO_DAYS(NOW())-TO_DAYS(CREATE_TIME) = 1 order by create_time desc &quot; &amp;gt; /data/backup/tj_order_${ctime}.xls&lt;/span&gt;
iconv -futf8 -tgb2312 -otj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;_gb2312.xls tj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;.xls
&lt;span class=&quot;c&quot;&gt;#iconv -futf8 -tgb2312 -otj_order_${ctime}_gb2312.xls tj_order_${ctime}.xls&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;date +%Y%m%d&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
mysql iptv_pet -uroot -p&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt; -e &lt;span class=&quot;s2&quot;&gt;&quot;call SP_PET_STATISTICS(1)&quot;&lt;/span&gt; &amp;gt; /data/backup/tj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;_utf8.xls
&lt;span class=&quot;c&quot;&gt;#mysql iptv_pet -uroot -p****** -e &quot;select user_id,code ,create_time from tbl_statistics_order where code like '%result_0' and TO_DAYS(NOW())-TO_DAYS(CREATE_TIME) = 1 order by create_time desc &quot; &amp;gt; /data/backup/tj_order_${ctime}_utf8.xls&lt;/span&gt;
sleep 1
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! -f &lt;span class=&quot;s2&quot;&gt;&quot;/data/backup/tj_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_utf8.xls&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
&lt;/span&gt;iconv -futf8 -tgb2312 -o/data/backup/tj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;.xls /data/backup/tj_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ctime&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;_utf8.xls
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;mysql-备份&quot;&gt;mysql 备份&lt;/h3&gt;
&lt;h4 id=&quot;1导出数据库&quot;&gt;1.导出数据库：&lt;/h4&gt;
&lt;h5 id=&quot;11-执行如下命令可导出数据库所有表的数据&quot;&gt;1.1 执行如下命令，可导出数据库所有表的数据：&lt;/h5&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump -uroot -p iptv_pet &amp;gt; db_bak_iptv_pet_20160822.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h5 id=&quot;111-执行如下命令可导出数据库中某个表的数据&quot;&gt;1.1.1 执行如下命令，可导出数据库中某个表的数据：&lt;/h5&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump -uroot -p iptv_pet cms_channel &amp;gt; db_bak_iptv_pet_cmschannel_20160822.sql

/usr/local/mysql/bin/mysqldump -uroot -p iptv_pet cms_channel cms_document &amp;gt; db_bak_iptv_pet_cmschannel_20160822.sql

/usr/local/mysql/bin/mysqldump -uroot -p iptv_pet tbl_stat_order tbl_stat_click tbl_stat_click_manage &amp;gt; db_bak_tbl_stat_20170301.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;112-执行如下命令可导出数据库中某个表的部分数据&quot;&gt;1.1.2 执行如下命令，可导出数据库中某个表的部分数据&lt;/h5&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump -uroot -p iptv_pet tbl_statistics_player_201705 --where=&quot; TO_DAYS(NOW()) - TO_DAYS(CREATE_TIME) = 1&quot; &amp;gt; db_bak_tbl_statistics_player_20170505.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;12-执行如下命令可导出数据库存储过程&quot;&gt;1.2 执行如下命令，可导出数据库存储过程：&lt;/h5&gt;
&lt;p&gt;注意：–events必须在数据库名称后面&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump -uroot -p -n -t -d -R --triggers=false iptv_pet --events &amp;gt; db_bak_iptv_pet_sp_20160822.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;2编写shell文件定时备份&quot;&gt;2.编写shell文件，定时备份&lt;/h4&gt;
&lt;h5 id=&quot;21-需求如下&quot;&gt;2.1 需求如下：&lt;/h5&gt;
&lt;p&gt;2.1.1 每天4点备份mysql数据&lt;/p&gt;

&lt;p&gt;2.1.2 为节省空间，删除超过3个月的所有备份数据；&lt;/p&gt;

&lt;p&gt;2.1.3 删除超过7天的备份数据，保留3个月里的 10号 20号 30号的备份数据；&lt;/p&gt;

&lt;h5 id=&quot;22-实现方式如下&quot;&gt;2.2 实现方式如下：&lt;/h5&gt;
&lt;p&gt;2.2.1 创建shell文件&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vim backup_mysql.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;2.2.2 编辑shell文件，内容如下：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysqldump -uroot -p123456 --all-databases &amp;gt; /data/dbdata/mysqlbak/`date +%Y%m%d`.sql
find /data/dbdata/mysqlbak/ -mtime +7 -name '*[1-9].sql' -exec rm -rf {} \;
find /data/dbdata/mysqlbak/ -mtime +92 -name '*.sql' -exec rm -rf {} \;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;2.2.3 创建定时任务&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crontab –e
0 4 * * * /data/dbdata/backup_mysql.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;mysql-还原&quot;&gt;mysql 还原&lt;/h3&gt;
&lt;p&gt;导入数据&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql&amp;gt; source /home/qinglan/data/mysql/iptv_health.sql
Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected, 1 warning (0.00 sec)

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;日常操作语句归纳&quot;&gt;日常操作语句归纳&lt;/h3&gt;
&lt;p&gt;mysql 添加表字段&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;alter table tbl_exp_card add activation_user varchar(50) NULL COMMENT '激活用户';
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Thu, 19 Jul 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/07/mysql_backup/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/mysql_backup/</guid>
        
        <category>数据库</category>
        
        <category>MySQL</category>
        
        
        <category>数据库</category>
        
      </item>
    
      <item>
        <title>Linux防火墙设置</title>
        <description>&lt;p&gt;Linux防火墙设置&lt;/p&gt;

&lt;h3 id=&quot;centos-65&quot;&gt;CentOS 6.5&lt;/h3&gt;

&lt;h4 id=&quot;查看防火墙的状态&quot;&gt;查看防火墙的状态&lt;/h4&gt;

&lt;h4 id=&quot;查看已经开放的端口&quot;&gt;查看已经开放的端口&lt;/h4&gt;

&lt;h4 id=&quot;开启端口&quot;&gt;开启端口&lt;/h4&gt;

&lt;h4 id=&quot;启动防火墙&quot;&gt;启动防火墙&lt;/h4&gt;

&lt;h4 id=&quot;关闭防火墙&quot;&gt;关闭防火墙&lt;/h4&gt;

&lt;h4 id=&quot;重启防火墙&quot;&gt;重启防火墙&lt;/h4&gt;

&lt;h3 id=&quot;centos-7&quot;&gt;CentOS 7&lt;/h3&gt;

&lt;h4 id=&quot;查看防火墙的状态-1&quot;&gt;查看防火墙的状态&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --state
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;查看已经开放的端口-1&quot;&gt;查看已经开放的端口&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;firewall-cmd --list-ports
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;开启端口-1&quot;&gt;开启端口&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;firewall-cmd --zone=public --add-port=80/tcp --permanent
firewall-cmd --zone=public --add-port=30000-31000/tcp --permanent
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;启动防火墙-1&quot;&gt;启动防火墙&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;关闭防火墙-1&quot;&gt;关闭防火墙&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systemctl start firewalld.service #启动firewall
systemctl stop firewalld.service #停止firewall
systemctl disable firewalld.service #禁止firewall开机启动
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;重启防火墙-1&quot;&gt;重启防火墙&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 13 Jul 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/07/linux_firewall/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/linux_firewall/</guid>
        
        <category>防火墙</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>linux服务器架设FTP</title>
        <description>&lt;p&gt;linux服务器架设FTP&lt;/p&gt;

&lt;h3 id=&quot;准备工作&quot;&gt;准备工作&lt;/h3&gt;

&lt;h4 id=&quot;下载新版本ftp&quot;&gt;下载新版本FTP&lt;/h4&gt;

&lt;p&gt;下载地址：https://pkgs.org/download/vsftpd/&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;根据服务器选择相应版本，此处选择CentOS 6的版本&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;安装ftp&quot;&gt;安装FTP&lt;/h3&gt;

&lt;h4 id=&quot;检查安装vsftpd软件&quot;&gt;检查安装vsftpd软件&lt;/h4&gt;
&lt;p&gt;使用如下命令查询是否安装vsftpd软件&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#rpm -qa |grep vsftpd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;安装vsftpd软件&quot;&gt;安装vsftpd软件&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpm -ivh vsftpd-2.2.2-24.el6.i686.rpm
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;需要安装依赖包，且依赖包较多，有网络条件最好用yum安装。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum -y install vsftpd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;配置vsftpd&quot;&gt;配置vsftpd&lt;/h4&gt;
&lt;p&gt;ftp的配置文件主要有三个，位于/etc/vsftpd/目录下，分别是：
vsftpd.conf   vsftpd的主配置文件
ftpusers    该文件用来指定那些用户不能访问ftp服务器。
user_list   该文件用来指示的默认账户在默认情况下也不能访问ftp&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/vsftpd/vsftpd.conf


# 是否允许匿名登录（将其禁止）
anonymous_enable=NO
local_enable=YES

# 仅在没有pam验证版本时有用,是否检查用户有一个有效的shell来登录
check_shell=NO

# 设置连接超时时间（单位秒）
idle_session_timeout=600

# 数据传输超时时间（单位秒）
data_connection_timeout=120

# 是否允许上传/下载二进制文件
ascii_upload_enable=YES
ascii_download_enable=YES

# 限制所有的本地用户只能访问自己的目录
chroot_local_user=YES

# 是否允许使用ls -R等命令
ls_recurse_enable=YES

# [新增]是否只允许userlist_file文件中的用户登录FTP服务器，userlist_enable为YES才生效
# YES，默认值，禁止文件中的用户登录，同时也不向这些用户发出输入密码的提示。
# NO，只允许在文件中的用户登录FTP服务器
userlist_deny=NO

# [新增]所有用户的根目录（对匿名用户无效）
local_root=/data/ftpdata

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;新增ftp用户并为其设置密码&quot;&gt;新增ftp用户并为其设置密码&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# useradd ftpuser -s /sbin/nologin
# password ftpuser
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;编辑user_list文件给予用户访问ftp权限&quot;&gt;编辑user_list文件，给予用户访问ftp权限&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vi /etc/vsftpd/user_list
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;在文件末尾加入ftpuser并保存&lt;/p&gt;

&lt;h4 id=&quot;建立可访问目录并指定用户&quot;&gt;建立可访问目录并指定用户&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir -p /data/ftpdata
# chown -R ftpuser /data/ftpdata/ # 注意后面有个/
# chmod -R 755 /data/ftpdata
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;使用vsftpd软件&quot;&gt;使用vsftpd软件&lt;/h4&gt;

&lt;p&gt;主要包括如下几个命令：
启动ftp命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#service vsftpd start

# 如果报错提示：Redirecting to /bin/systemctl start vsftpd.service，请使用
# systemctl start vsftpd.service
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;停止ftp命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#service vsftpd stop
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;重启ftp命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#service vsftpd restart
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;开机启动vsftpd服务&quot;&gt;开机启动vsftpd服务&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chkconfig vsftpd on
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;解决无法登录问题&quot;&gt;解决无法登录问题&lt;/h4&gt;
&lt;h5 id=&quot;错误信息如下&quot;&gt;错误信息如下：&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;状态:     正在连接 XXX.XXX.XXX.XXX:21...
状态:     连接建立，等待欢迎消息...
命令:     USER root
响应:     331 Please specify the password.
命令:     PASS ***************
响应:     530 Login incorrect.
错误:     严重错误: 无法连接到服务器

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h5 id=&quot;错误原因及解决办法&quot;&gt;错误原因及解决办法：&lt;/h5&gt;

&lt;p&gt;原因一：启用了PAM，解决办法，删除文件/etc/pam.d/vsftpd&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo rm /etc/pam.d/vsftpd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;原因二：密码错误&lt;/p&gt;

&lt;h4 id=&quot;解决vsftpd-读取目录列表失败的问题&quot;&gt;解决vsftpd 读取目录列表失败的问题&lt;/h4&gt;
&lt;h5 id=&quot;错误信息如下-1&quot;&gt;错误信息如下：&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;...

状态:    已连接
状态:    读取目录列表...
命令:    PWD
响应:    257 &quot;/&quot;
命令:    TYPE I
响应:    200 Switching to Binary mode.
命令:    PASV
响应:    227 Entering Passive Mode (192,168,1,6,23,8).
命令:    LIST
错误:    连接超时
错误:    读取目录列表失败
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;错误原因&quot;&gt;错误原因：&lt;/h5&gt;
&lt;p&gt;该错误是由iptables的配置引起的&lt;/p&gt;

&lt;h5 id=&quot;解决办法&quot;&gt;解决办法：&lt;/h5&gt;

&lt;p&gt;临时的解决方法是执行如下命令,但当你重新启动服务器则iptables规则失效，又会出现相同的情况：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# modprobe ip_nat_ftp
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;永久解决方法，需要修改/etc/sysconfig/iptables-config文件：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/sysconfig/iptables-config

......

IPTABLES_MODULES=&quot;ip_nat_ftp&quot;
IPTABLES_MODULES_UNLOAD=&quot;yes&quot;

......

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;IPTABLES_MODULES_UNLOAD=”yes”的意义：每次iptables停止或者重启都会Unload modules
IPTABLES_MODULES=”“的意义：每次防火墙规则应用以后加载的模块
我们需要把IPTABLES_MODULES=”“修改为：IPTABLES_MODULES=”ip_nat_ftp”，这样重启服务器之后就不必再每次都执行mobprobe啦&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;vsftpd配置文件详解&quot;&gt;vsftpd配置文件详解&lt;/h4&gt;

&lt;p&gt;1.默认配置：
a.允许匿名用户和本地用户登陆。
     anonymous_enable=YES
     local_enable=YES
b.匿名用户使用的登陆名为ftp或anonymous，口令为空；匿名用户不能离开匿名用户家目录/var/ftp,且只能下载不能上传。
c.本地用户的登录名为本地用户名，口令为此本地用户的口令；本地用户可以在自 己家目录中进行读写操作；本地用户可以离开自家目录切换至有权限访问的其他目录，并在权限允许的情况下进行上传/下载。
    write_enable=YES
4&amp;gt;写在文件/etc/vsftpd.ftpusers中的本地用户禁止登陆。&lt;/p&gt;

&lt;p&gt;2.配置文件格式：&lt;br /&gt;
vsftpd.conf 的内容非常单纯，每一行即为一项设定。若是空白行或是开头为#的一行，将会被忽略。内容的格式只有一种，如下所示
option=value
要注意的是，等号两边不能加空白。&lt;/p&gt;

&lt;p&gt;3.匿名用户（anonymous）设置
anonymous_enable=YES/NO（YES）
控制是否允许匿名用户登入，YES 为允许匿名登入，NO 为不允许。默认值为YES。
write_enable=YES/NO（YES）
是否允许登陆用户有写权限。属于全局设置，默认值为YES。
no_anon_password=YES/NO（NO）
若是启动这项功能，则使用匿名登入时，不会询问密码。默认值为NO。
ftp_username=ftp
定义匿名登入的使用者名称。默认值为ftp。
anon_root=/var/ftp
使用匿名登入时，所登入的目录。默认值为/var/ftp。注意ftp目录不能是777的权限属性，即匿名用户的家目录不能有777的权限。
anon_upload_enable=YES/NO（NO）
如果设为YES，则允许匿名登入者有上传文件（非目录）的权限，只有在write_enable=YES时，此项才有效。当然，匿名用户必须要有对上层目录的写入权。默认值为NO。
anon_world_readable_only=YES/NO（YES）
如果设为YES，则允许匿名登入者下载可阅读的档案（可以下载到本机阅读，不能直接在FTP服务器中打开阅读）。默认值为YES。
anon_mkdir_write_enable=YES/NO（NO）
如果设为YES，则允许匿名登入者有新增目录的权限，只有在write_enable=YES时，此项才有效。当然，匿名用户必须要有对上层目录的写入权。默认值为NO。
anon_other_write_enable=YES/NO（NO）
如果设为YES，则允许匿名登入者更多于上传或者建立目录之外的权限，譬如删除或者重命名。（如果anon_upload_enable=NO，则匿名用户不能上传文件，但可以删除或者重命名已经存在的文件；如果anon_mkdir_write_enable=NO，则匿名用户不能上传或者新建文件夹，但可以删除或者重命名已经存在的文件夹。）默认值为NO。
chown_uploads=YES/NO（NO）
设置是否改变匿名用户上传文件（非目录）的属主。默认值为NO。
chown_username=username
设置匿名用户上传文件（非目录）的属主名。建议不要设置为root。
anon_umask=077
设置匿名登入者新增或上传档案时的umask 值。默认值为077，则新建档案的对应权限为700。
deny_email_enable=YES/NO（NO）
若是启动这项功能，则必须提供一个档案/etc/vsftpd/banner_emails，内容为email address。若是使用匿名登入，则会要求输入email address，若输入的email address 在此档案内，则不允许进入。默认值为NO。
banned_email_file=/etc/vsftpd/banner_emails
此文件用来输入email address，只有在deny_email_enable=YES时，才会使用到此档案。若是使用匿名登入，则会要求输入email address，若输入的email address 在此档案内，则不允许进入。&lt;/p&gt;

&lt;p&gt;4.本地用户设置
local_enable=YES/NO（YES）
控制是否允许本地用户登入，YES 为允许本地用户登入，NO为不允许。默认值为YES。
local_root=/home/username
当本地用户登入时，将被更换到定义的目录下。默认值为各用户的家目录。
write_enable=YES/NO（YES）
是否允许登陆用户有写权限。属于全局设置，默认值为YES。
local_umask=022
本地用户新增档案时的umask 值。默认值为077。
file_open_mode=0755
本地用户上传档案后的档案权限，与chmod 所使用的数值相同。默认值为0666。&lt;/p&gt;

&lt;p&gt;5.欢迎语设置
dirmessage_enable=YES/NO（YES）
如果启动这个选项，那么使用者第一次进入一个目录时，会检查该目录下是否有.message这个档案，如果有，则会出现此档案的内容，通常这个档案会放置欢迎话语，或是对该目录的说明。默认值为开启。
message_file=.message
设置目录消息文件，可将要显示的信息写入该文件。默认值为.message。
banner_file=/etc/vsftpd/banner
当使用者登入时，会显示此设定所在的档案内容，通常为欢迎话语或是说明。默认值为无。如果欢迎信息较多，则使用该配置项。
ftpd_banner=Welcome to BOB’s FTP server
这里用来定义欢迎话语的字符串，banner_file是档案的形式，而ftpd_banner 则是字符串的形式。预设为无。&lt;/p&gt;

&lt;p&gt;6.控制用户是否允许切换到上级目录
在默认配置下，本地用户登入FTP后可以使用cd命令切换到其他目录，这样会对系统带来安全隐患。可以通过以下三条配置文件来控制用户切换目录。
chroot_list_enable=YES/NO（NO）
设置是否启用chroot_list_file配置项指定的用户列表文件。默认值为NO。
chroot_list_file=/etc/vsftpd.chroot_list
用于指定用户列表文件，该文件用于控制哪些用户可以切换到用户家目录的上级目录。
chroot_local_user=YES/NO（NO）
用于指定用户列表文件中的用户是否允许切换到上级目录。默认值为NO。
通过搭配能实现以下几种效果：
①当chroot_list_enable=YES，chroot_local_user=YES时，在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；未在文件中列出的用户，不能切换到其他目录。
②当chroot_list_enable=YES，chroot_local_user=NO时，在/etc/vsftpd.chroot_list文件中列出的用户，不能切换到其他目录；未在文件中列出的用户，可以切换到其他目录。
③当chroot_list_enable=NO，chroot_local_user=YES时，所有的用户均不能切换到其他目录。
④当chroot_list_enable=NO，chroot_local_user=NO时，所有的用户均可以切换到其他目录。&lt;/p&gt;

&lt;p&gt;7.数据传输模式设置
FTP在传输数据时，可以使用二进制方式，也可以使用ASCII模式来上传或下载数据。
ascii_upload_enable=YES/NO（NO）
设置是否启用ASCII 模式上传数据。默认值为NO。
ascii_download_enable=YES/NO（NO）
设置是否启用ASCII 模式下载数据。默认值为NO。&lt;/p&gt;

&lt;p&gt;8.访问控制设置
两种控制方式：一种控制主机访问，另一种控制用户访问。
①控制主机访问：
tcp_wrappers=YES/NO（YES）
设置vsftpd是否与tcp wrapper相结合来进行主机的访问控制。默认值为YES。如果启用，则vsftpd服务器会检查/etc/hosts.allow 和/etc/hosts.deny 中的设置，来决定请求连接的主机，是否允许访问该FTP服务器。这两个文件可以起到简易的防火墙功能。
比如：若要仅允许192.168.0.1—192.168.0.254的用户可以连接FTP服务器，则在/etc/hosts.allow文件中添加以下内容：
vsftpd:192.168.0. :allow
all:all :deny
②控制用户访问：
对于用户的访问控制可以通过/etc目录下的vsftpd.user_list和ftpusers文件来实现。
userlist_file=/etc/vsftpd.user_list
控制用户访问FTP的文件，里面写着用户名称。一个用户名称一行。
userlist_enable=YES/NO（NO）
是否启用vsftpd.user_list文件。
userlist_deny=YES/NO（YES）
决定vsftpd.user_list文件中的用户是否能够访问FTP服务器。若设置为YES，则vsftpd.user_list文件中的用户不允许访问FTP，若设置为NO，则只有vsftpd.user_list文件中的用户才能访问FTP。
/etc/vsftpd/ftpusers文件专门用于定义不允许访问FTP服务器的用户列表（注意:如果userlist_enable=YES,userlist_deny=NO,此时如果在vsftpd.user_list和ftpusers中都有某个用户时，那么这个用户是不能够访问FTP的，即ftpusers的优先级要高）。默认情况下vsftpd.user_list和ftpusers，这两个文件已经预设置了一些不允许访问FTP服务器的系统内部账户。如果系统没有这两个文件，那么新建这两个文件，将用户添加进去即可。&lt;/p&gt;

&lt;p&gt;9.访问速率设置
anon_max_rate=0
设置匿名登入者使用的最大传输速度，单位为B/s，0 表示不限制速度。默认值为0。
local_max_rate=0
本地用户使用的最大传输速度，单位为B/s，0 表示不限制速度。预设值为0。&lt;/p&gt;

&lt;p&gt;10.超时时间设置
accept_timeout=60
设置建立FTP连接的超时时间，单位为秒。默认值为60。
connect_timeout=60
PORT 方式下建立数据连接的超时时间，单位为秒。默认值为60。
data_connection_timeout=120
设置建立FTP数据连接的超时时间，单位为秒。默认值为120。
idle_session_timeout=300
设置多长时间不对FTP服务器进行任何操作，则断开该FTP连接，单位为秒。默认值为300 。&lt;/p&gt;

&lt;p&gt;11.日志文件设置
xferlog_enable= YES/NO（YES）
是否启用上传/下载日志记录。如果启用，则上传与下载的信息将被完整纪录在xferlog_file 所定义的档案中。预设为开启。
xferlog_file=/var/log/vsftpd.log
设置日志文件名和路径，默认值为/var/log/vsftpd.log。
xferlog_std_format=YES/NO（NO）
如果启用，则日志文件将会写成xferlog的标准格式，如同wu-ftpd 一般。默认值为关闭。
log_ftp_protocol=YES|NO（NO） 
如果启用此选项，所有的FTP请求和响应都会被记录到日志中，默认日志文件在/var/log/vsftpd.log。启用此选项时，xferlog_std_format不能被激活。这个选项有助于调试。默认值为NO。&lt;/p&gt;

&lt;p&gt;12.定义用户配置文件
在vsftpd中，可以通过定义用户配置文件来实现不同的用户使用不同的配置。
user_config_dir=/etc/vsftpd/userconf
设置用户配置文件所在的目录。当设置了该配置项后，用户登陆服务器后，系统就会到/etc/vsftpd/userconf目录下，读取与当前用户名相同的文件，并根据文件中的配置命令，对当前用户进行更进一步的配置。
例如：定义user_config_dir=/etc/vsftpd/userconf，且主机上有使用者 test1,test2，那么我们就在user_config_dir 的目录新增文件名为test1和test2两个文件。若是test1 登入，则会读取user_config_dir 下的test1 这个档案内的设定。默认值为无。利用用户配置文件，可以实现对不同用户进行访问速度的控制，在各用户配置文件中定义local_max_rate=XX，即可。&lt;/p&gt;

&lt;p&gt;13.FTP的工作方式与端口设置
FTP有两种工作方式：PORT FTP（主动模式）和PASV FTP（被动模式）
listen_port=21
设置FTP服务器建立连接所监听的端口，默认值为21。
connect_from_port_20=YES/NO
指定FTP使用20端口进行数据传输，默认值为YES。
ftp_data_port=20
设置在PORT方式下，FTP数据连接使用的端口，默认值为20。
pasv_enable=YES/NO（YES）
若设置为YES，则使用PASV工作模式；若设置为NO，则使用PORT模式。默认值为YES，即使用PASV工作模式。
pasv_max_port=0
在PASV工作模式下，数据连接可以使用的端口范围的最大端口，0 表示任意端口。默认值为0。
pasv_min_port=0
在PASV工作模式下，数据连接可以使用的端口范围的最小端口，0 表示任意端口。默认值为0。&lt;/p&gt;

&lt;p&gt;14.与连接相关的设置
listen=YES/NO（YES）
设置vsftpd服务器是否以standalone模式运行。以standalone模式运行是一种较好的方式，此时listen必须设置为YES，此为默认值。建议不要更改，有很多与服务器运行相关的配置命令，需要在此模式下才有效。若设置为NO，则vsftpd不是以独立的服务运行，要受到xinetd服务的管控，功能上会受到限制。
max_clients=0
设置vsftpd允许的最大连接数，默认值为0，表示不受限制。若设置为100时，则同时允许有100个连接，超出的将被拒绝。只有在standalone模式运行才有效。
max_per_ip=0
设置每个IP允许与FTP服务器同时建立连接的数目。默认值为0，表示不受限制。只有在standalone模式运行才有效。
listen_address=IP地址
设置FTP服务器在指定的IP地址上侦听用户的FTP请求。若不设置，则对服务器绑定的所有IP地址进行侦听。只有在standalone模式运行才有效。
setproctitle_enable=YES/NO（NO）
设置每个与FTP服务器的连接，是否以不同的进程表现出来。默认值为NO，此时使用ps aux |grep ftp只会有一个vsftpd的进程。若设置为YES，则每个连接都会有一个vsftpd的进程。&lt;/p&gt;

&lt;p&gt;15.虚拟用户设置
虚拟用户使用PAM认证方式。
pam_service_name=vsftpd
设置PAM使用的名称，默认值为/etc/pam.d/vsftpd。
guest_enable= YES/NO（NO）
启用虚拟用户。默认值为NO。
guest_username=ftp
这里用来映射虚拟用户。默认值为ftp。
virtual_use_local_privs=YES/NO（NO）
当该参数激活（YES）时，虚拟用户使用与本地用户相同的权限。当此参数关闭（NO）时，虚拟用户使用与匿名用户相同的权限。默认情况下此参数是关闭的（NO）。&lt;/p&gt;

&lt;p&gt;16.其他设置
text_userdb_names= YES/NO（NO）
设置在执行ls –la之类的命令时，是显示UID、GID还是显示出具体的用户名和组名。默认值为NO，即以UID和GID方式显示。若希望显示用户名和组名，则设置为YES。
ls_recurse_enable=YES/NO（NO）
若是启用此功能，则允许登入者使用ls –R（可以查看当前目录下子目录中的文件）这个指令。默认值为NO。
hide_ids=YES/NO（NO）
如果启用此功能，所有档案的拥有者与群组都为ftp，也就是使用者登入使用ls -al之类的指令，所看到的档案拥有者跟群组均为ftp。默认值为关闭。
download_enable=YES/NO（YES）
如果设置为NO，所有的文件都不能下载到本地，文件夹不受影响。默认值为YES。&lt;/p&gt;

&lt;p&gt;关于ftpusers和user_list两个文件的说明
问题一：ftpusers和user_list两个文件各自的用途是什么？有何关系？
首先请明确一点：ftpusers不受任何配制项的影响，它总是有效，它是一个黑名单！
而user_list则是和vsftpd.conf中的userlist_enable和userlist_deny两个配置项紧密相关的，它可以有效，也可以无效，有效时它可以是一个黑名单，也可以是一个白名单！&lt;/p&gt;

&lt;p&gt;问题二：vsftpd.conf中的userlist_enable和userlist_deny两个配置项各自起什么作用，两者如何搭配使用?
1.userlist_enable和userlist_deny两个选项联合起来针对的是：本地全体用户（除去ftpusers中的用户）和出现在user_list文件中的用户以及不在在user_list文件中的用户这三类用户集合进行的设置。
2.当且仅当userlist_enable=YES时：userlist_deny项的配置才有效，user_list文件才会被使用；当其为NO时，无论userlist_deny项为何值都是无效的，本地全体用户（除去ftpusers中的用户）都可以登入FTP
3.当userlist_enable=YES时，userlist_deny=YES时：user_list是一个黑名单，即：所有出现在名单中的用户都会被拒绝登入；
4.当userlist_enable=YES时，userlist_deny=NO时：user_list是一个白名单，即：只有出现在名单中的用户才会被准许登入(user_list之外的用户都被拒绝登入)；另外需要特别提醒的是：使用白名单后，匿名用户将无法登入！除非显式在user_list中加入一行：anonymous&lt;/p&gt;

</description>
        <pubDate>Wed, 06 Dec 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/12/linux_ftp/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/linux_ftp/</guid>
        
        <category>FTP,服务器架设,CentOS</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>Tomcat的URL中存在特殊符号报404错误</title>
        <description>&lt;p&gt;Tomcat的URL中存在特殊符号报404错误&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;当url中存在 \&lt;/td&gt;
      &lt;td&gt;{ } 等字符串时，tomcat报404错误，后台报错信息如下：&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;信息: Error parsing HTTP request header
 Note: further occurrences of HTTP header parsing errors will be logged at DEBUG level.
java.lang.IllegalArgumentException: Invalid character found in the request target. The valid characters are defined in RFC 7230 and RFC 3986
        at org.apache.coyote.http11.InternalInputBuffer.parseRequestLine(InternalInputBuffer.java:192)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1028)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:637)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:318)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
        at java.lang.Thread.run(Thread.java:745)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Fri, 24 Nov 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/11/tomcat_url_invalid_character/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/tomcat_url_invalid_character/</guid>
        
        <category>Tomcat</category>
        
        
        <category>技术开发</category>
        
      </item>
    
      <item>
        <title>CentOS 6.5升级OpenSSH步骤</title>
        <description>&lt;h3 id=&quot;安装telnet服务我本地安装的没有做这步操作&quot;&gt;安装telnet服务（我本地安装的没有做这步操作）&lt;/h3&gt;

&lt;h4 id=&quot;安装软件&quot;&gt;安装软件&lt;/h4&gt;
&lt;p&gt;1 # yum -y install telnet-server* telnet&lt;/p&gt;

&lt;p&gt;2.启用telnet服务&lt;/p&gt;
&lt;h1 id=&quot;vi-etcxinetddtelnet&quot;&gt;vi /etc/xinetd.d/telnet&lt;/h1&gt;
&lt;p&gt;将其中disable字段的yes改为no以启用telnet服务&lt;/p&gt;
&lt;h1 id=&quot;mv-etcsecuretty-etcsecurettyold----允许root用户通过telnet登录&quot;&gt;mv /etc/securetty /etc/securetty.old    #允许root用户通过telnet登录&lt;/h1&gt;
&lt;h1 id=&quot;service-xinetd-start--------------------启动telnet服务&quot;&gt;service xinetd start                    #启动telnet服务&lt;/h1&gt;
&lt;h1 id=&quot;chkconfig-xinetd-on--------------------使telnet服务开机启动避免升级过程中服务器意外重启后无法远程登录系统&quot;&gt;chkconfig xinetd on                    #使telnet服务开机启动，避免升级过程中服务器意外重启后无法远程登录系统&lt;/h1&gt;

&lt;p&gt;3.测试telnet能否正常登入系统&lt;/p&gt;

&lt;h3 id=&quot;卸载当前openssh&quot;&gt;卸载当前openssh&lt;/h3&gt;
&lt;h4 id=&quot;备份当前openssh&quot;&gt;备份当前openssh&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mv /etc/ssh /etc/ssh.old
# mv /etc/init.d/sshd /etc/init.d/sshd.old
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;卸载当前openssh-1&quot;&gt;卸载当前openssh&lt;/h4&gt;

&lt;h5 id=&quot;查看已安装的openssh&quot;&gt;查看已安装的openssh&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm -qa | grep openssh
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;删除&quot;&gt;删除&lt;/h5&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm -qa |grep openssh|xargs -i rpm -e --nodeps {}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Thu, 19 Oct 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/10/linux_update_openssh/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/linux_update_openssh/</guid>
        
        <category>CentOS</category>
        
        <category>服务器架设</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>保留旧版本安装新版本MySQL</title>
        <description>&lt;p&gt;保留旧版本安装新版本mysql&lt;/p&gt;

&lt;h3 id=&quot;准备工作&quot;&gt;准备工作&lt;/h3&gt;

&lt;h4 id=&quot;下载新版本mysql&quot;&gt;下载新版本MySQL&lt;/h4&gt;
&lt;p&gt;下载地址：http://www.mysql.com/downloads/&lt;/p&gt;

&lt;p&gt;依次选择 MySQL Community Edition (GPL) MySQL社区版（GPL）–&amp;gt; MySQL Community Server (GPL) MySQL社区服务器（GPL）&lt;/p&gt;

&lt;p&gt;操作系统选择：Source Code&lt;/p&gt;

&lt;p&gt;下载如下版本：Generic Linux (Architecture Independent), Compressed TAR Archive Includes Boost Headers&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;选择包含Boost的Generic Linux版本，应为每个版本对应的Boost版本有要求，直接选择包含Boost的版本不会出现版本不对应的情况&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;添加系统mysql组和mysql用户&quot;&gt;添加系统mysql组和mysql用户&lt;/h4&gt;

&lt;p&gt;查看是否有mysql组和mysql用户，没有则添加&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /etc/passwd
# cat /etc/group
# groupadd mysql
# useradd -r -g mysql mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;创建安装目录并修改目录拥有者&quot;&gt;创建安装目录并修改目录拥有者&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /usr/local/mysql3308
# mkdir /data/mysql3308
# chown -R mysql:mysql /usr/local/mysql3308
# chown -R mysql:mysql /data/mysql3308

# mkdir /etc/mysql3308
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;备份mysql&quot;&gt;备份MySQL&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump -uroot -p db_name &amp;gt; db_bak_db_name_20160822.sql
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;安装新版本mysql&quot;&gt;安装新版本MySQL&lt;/h3&gt;
&lt;p&gt;然后解压并跳转到解压目录进行编译安装&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# tar -xzvf mysql-boost-5.7.19.tar.gz
# cd mysql-boost-5.7.19

# cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql3308 \
-DMYSQL_DATADIR=/data/mysql3308 \
-DMYSQL_UNIX_ADDR=/data/mysql3308/mysql.sock \
-DSYSCONFDIR=/etc/mysql3308 \
-DMYSQL_USER=mysql \
-DMYSQL_TCP_PORT=3308 \
-DDEFAULT_CHARSET=utf8mb4 \
-DDEFAULT_COLLATION=utf8mb4_general_ci \
-DEXTRA_CHARSETS=all \
-DWITH_MYISAM_STORAGE_ENGINE=1 \
-DWITH_INNOBASE_STORAGE_ENGINE=1 \
-DWITH_ARCHIVE_STORAGE_ENGINE=1 \
-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \
-DWITH_MEMORY_STORAGE_ENGINE=1 \
-DWITH_PARTITION_STORAGE_ENGINE=1 \
-DWITH_READLINE=1 \
-DENABLED_LOCAL_INFILE=1 \
-DWITH_EMBEDDED_SERVER=1 \
-DWITH_BOOST=boost/boost_1_59_0

# make &amp;amp;&amp;amp; make install
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;DWITH_BOOST参数对应的是刚刚解压后的boost目录&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;DSYSCONFDIR参数为配置文件my.cnf存放路径&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;初始化mysqld&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql3308 --datadir=/data/mysql3308
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;初始化后会生成默认临时密码，记住密码一会儿登录时需要：A temporary password is generated for root@localhost: ET#&amp;amp;dQs_p22%&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;添加mysql配置文件&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/mysql3308/my.cnf
...
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;添加启动项配置&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd /usr/local/mysql3308/support-files
# cp mysql.server /etc/init.d/mysql3308
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;修改/etc/init.d/mysql3308文件中的如下代码&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;basedir=/usr/local/mysql3308
datadir=/data/mysql3308
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;设置为系统服务&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chkconfig --add mysql3308
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;启动服务&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# service mysql3308 restart
...

# /usr/local/mysql3308/bin/mysql -uroot -p
Enter password: 
...
mysql&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;输入之前初始化时候的密码进入，首次使用会有提示修改密码&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql&amp;gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'abc1';
mysql&amp;gt; FLUSH PRIVILEGES;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;测试mysql&quot;&gt;测试MySQL&lt;/h3&gt;
&lt;p&gt;重启并测试&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# service mysql3308 restart
...

# /usr/local/mysql3308/bin/mysql -uroot -p     
Enter password: 
...
mysql&amp;gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;旧版本测试&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mysql -uroot -p
Enter password: 
...
mysql&amp;gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;通过如下命令可查看两个mysql的端口和连接数信息&lt;/p&gt;

&lt;p&gt;查询端口&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql&amp;gt; show global variables like 'port';
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;查询连接数&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql&amp;gt; show processlist;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;删除旧版本&quot;&gt;删除旧版本&lt;/h3&gt;
&lt;p&gt;如果是升级可迁移数据后删除旧版本&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm -qa | grep mysql
mysql-connector-odbc-5.1.5r1144-7.el6.x86_64
mysql-libs-5.1.71-1.el6.x86_64
mysql-5.1.71-1.el6.x86_64
mysql-server-5.1.71-1.el6.x86_64
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;逐一卸载&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm -e mysql-connector-odbc-5.1.5r1144-7.el6.x86_64
# rpm -e mysql-libs-5.1.71-1.el6.x86_64
# rpm -e mysql-5.1.71-1.el6.x86_64
# rpm -e mysql-server-5.1.71-1.el6.x86_64
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Thu, 19 Oct 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/10/linux_update_mysql/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/linux_update_mysql/</guid>
        
        <category>MySQL</category>
        
        <category>服务器架设</category>
        
        
        <category>linux</category>
        
      </item>
    
      <item>
        <title>Apache许可证2.0 中文版</title>
        <description>&lt;p&gt;Apache许可证
2.0版 2004年1月
http://www.apache.org/licenses/&lt;/p&gt;

&lt;p&gt;关于使用、复制和分发的条款&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;定义&lt;/p&gt;

    &lt;p&gt;“许可证”是指根据本文件第1到第9部分关于使用、复制和分发的条款。&lt;/p&gt;

    &lt;p&gt;“许可证颁发者”是指版权所有者或者由版权所有者授权许可证的实体。&lt;/p&gt;

    &lt;p&gt;“法律实体”是指实施实体和进行控制的所有其它实体受该实体控制，或者受该实体集中控制。根据此定义，”控制”是指(i)让无论是否签订协议的上述实体，进行指导或管理的直接权利或间接权利，或者(ii)拥有百分之五十(50%)或以上已发行股票的所有者，或者(iii)上述实体的实权所有者。&lt;/p&gt;

    &lt;p&gt;“用户”(或”用户的”)是指行使本许可证所授予权限的个人或法律实体。&lt;/p&gt;

    &lt;p&gt;“源程序”形式是指对包括但不限于软件源代码、文件源程序和配置文件进行修改的首选形式。&lt;/p&gt;

    &lt;p&gt;“目标”形式是指对源程序形式进行机械转换或翻译的任何形式，包括但不限于对编译的目标代码，生成的文件以及转换为其它媒体类型。&lt;/p&gt;

    &lt;p&gt;“作品”是指根据本许可证所制作的源程序形式或目标形式的著作，在著作中包含的或附加的版权通知(在下面附录中提供了一个示例)。&lt;/p&gt;

    &lt;p&gt;“衍生作品”是指基于作品(或从作品衍生而来)的源程序形式或目标形式的任何作品，以及编辑修订、注释、详细描述或其它修订等构成原创著作作品的整体。根据本许可证，衍生作品不得包括与作品及其衍生作品分离之作品，或仅与作品及其衍生作品的接口相链接(或按名称结合)之作品。&lt;/p&gt;

    &lt;p&gt;“贡献”是指任何著作作品，包括作品的原始版本和对该作品或衍生作品所做的任何修订或补充，意在提交给许可证颁发者以让版权所有者或代表版权所有者的授权个人或法律实体包含在其作品中。根据此定义，”提交”一词表示发送给许可证颁发者或其代表人，任何电子的、口头的或书面的交流信息形式，包括但不限于在由许可证颁发者或者代表其管理的电子邮件清单、源代码控制系统、以及发布跟踪系统上为讨论和提高作品的交流，但不包括由版权所有者以书面形式明显标注或指定为”非贡献”的交流活动。&lt;/p&gt;

    &lt;p&gt;“贡献者”是指许可证颁发者和代表从许可证颁发者接受之贡献的并随后包含在作品之贡献中的任何个人或法律实体。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;版权许可证的授予。根据本许可证的条款，每个贡献者授予用户永久性的、全球性的、非专有性的、免费的、无版权费的、不可撤销的版权许可证以源程序形式或目标形式复制、准备衍生作品、公开显示、公开执行、授予分许可证、以及分发作品和这样的衍生作品。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;专利许可证的授予。根据本许可证的条款，每个贡献者授予用户永久性的、全球性的、非专有性的、免费的、无版权费的、不可撤销的(除在本部分进行说明)专利许可证对作品进行制作、让人制作、使用、提供销售、销售、进口和其它转让，且这样的许可证仅适用于在所递交作品的贡献中因可由单一的或多个这样的贡献者授予而必须侵犯的申请专利。如果用户对任何实体针对作品或作品中所涉及贡献提出因直接性或贡献性专利侵权而提起专利法律诉讼(包括交互诉讼请求或反索赔)，那么根据本许可证，授予用户针对作品的任何专利许可证将在提起上述诉讼之日起终止。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;重新分发。用户可在任何媒介中复制和分发作品或衍生作品之副本，无论是否修订，还是以源程序形式或目标形式，条件是用户需满足下列条款：
   (a)用户必须为作品或衍生作品的任何其他接收者提供本许可证的副本；并且
   (b)用户必须让任何修改过的文件附带明显的通知，声明用户已更改文件；并且
   (c)用户必须从作品的源程序形式中保留衍生作品源程序形式的用户所分发的所有版权、专利、商标和属性通知，但不包括不属于衍生作品任何部分的类似通知；并且
   (d)如果作品将”通知”文本文件包括为其分发作品的一部分，那么用户分发的任何衍生作品中须至少在下列地方之一包括，在这样的通知文件中所包含的属性通知的可读副本，但不包括那些不属于衍生作品任何部分的通知：在作为衍生作品一部分而分发的通知文本文件中；如果与衍生作品一起提供则在源程序形式或文件中；或者通常作为第三方通知出现的时候和地方，在衍生作品中产生的画面中。通知文件的内容仅供信息提供，并未对许可证进行修改。用户可在其分发的衍生作品中在作品的通知文本后或作为附录添加自己的属性通知，条件是附加的属性通知不得构成修改本许可证。&lt;/p&gt;

    &lt;p&gt;用户可以为自身所做出的修订添加自己的版权声明并可对自身所做出修订内容或为这样的衍生作品作为整体的使用、复制或分发提供附加或不同的条款，条件是用户对作品的使用、复制和分发必须符合本许可证中声明的条款。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;贡献的提交。除非用户明确声明，在作品中由用户向许可证颁发者的提交若要包含在贡献中，必须在无任何附加条款下符合本许可证的条款。尽管上面如此规定，执行许可证颁发者有关贡献的条款时，任何情况下均不得替代或修改任何单独许可证协议的条款。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;商标。本许可证并未授予用户使用许可证颁发者的商号、商标、服务标记或产品名称，除非将这些名称用于合理性和惯例性描述作品起源和复制通知文件的内容时。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;保证否认条款。除非因适用法律需要或书面同意，许可证颁发者以”按原样”基础提供作品(并且每个贡献者提供其贡献)，无任何明示的或暗示的保证或条件，包括但不限于关于所有权、不侵权、商品适销性、或适用性的保证或条件。用户仅对使用或重新分发作品的正确性负责，并需承担根据本许可证行使权限时的任何风险。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;责任限制条款。在任何情况下并根据任何法律，无论是因侵权(包括过失)或根据合同，还是其它原因，除非根据适用法律需要(例如故意行为和重大过失行为)或经书面同意，即使贡献者事先已被告知发生损害的可能性，任何贡献者不就用户因使用本许可证或不能使用或无法使用作品(包括但不限于商誉损失、停工、计算机失效或故障，或任何商业损坏或损失)而造成的损失，包括直接的、非直接的、特殊的、意外的或间接的字符损坏而负责。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;接受保证或附加责任。重新分发作品或及其衍生作品时，用户可选择提供或为符合本许可证承担之支持、担保、赔偿或其它职责义务和/或权利而收取费用。但是，在承担上述义务时，用户只可代表用户本身和用户本身责任来执行，无需代表任何其它贡献者，并且用户仅可保证、防护并保持每个贡献者不受任何因此而产生的责任或对因用户自身承担这样的保证或附加责任而对这样的贡献者所提出的索赔。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;条款结束&lt;/p&gt;

&lt;p&gt;附录：如何向用户作品中应用Apache许可证。&lt;/p&gt;

&lt;p&gt;若要向用户作品应用Apache许可证，请附加下列样本通知，将括号”[]”中的字段以用户自身的区分信息来替换(但不包括括号)。文本必须以文件格式适当的注释句法包含在其中。另外建议将文件名或类别名以及目的说明包含在相同的”打印页”上作为版权通知，以更加容易的区分出第三方档案。&lt;/p&gt;

&lt;p&gt;版权所有[yyyy][版权所有者的名称]&lt;/p&gt;

&lt;p&gt;根据2.0版本Apache许可证(“许可证”)授权；
根据本许可证，用户可以不使用此文件。
用户可从下列网址获得许可证副本：&lt;/p&gt;

&lt;p&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/p&gt;

&lt;p&gt;除非因适用法律需要或书面同意，
根据许可证分发的软件是基于”按原样”基础提供，
无任何明示的或暗示的保证或条件。
详见根据许可证许可下，特定语言的管辖权限和限制。&lt;/p&gt;
</description>
        <pubDate>Tue, 26 Sep 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/09/Apache_License_Version_2.0_zh/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/Apache_License_Version_2.0_zh/</guid>
        
        <category>License</category>
        
        
      </item>
    
      <item>
        <title>Apache License Version 2.0</title>
        <description>&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                             Apache License
                       Version 2.0, January 2004
                    http://www.apache.org/licenses/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Definitions.&lt;/p&gt;

    &lt;p&gt;“License” shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.&lt;/p&gt;

    &lt;p&gt;“Licensor” shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.&lt;/p&gt;

    &lt;p&gt;“Legal Entity” shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
“control” means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.&lt;/p&gt;

    &lt;p&gt;“You” (or “Your”) shall mean an individual or Legal Entity
exercising permissions granted by this License.&lt;/p&gt;

    &lt;p&gt;“Source” form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.&lt;/p&gt;

    &lt;p&gt;“Object” form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.&lt;/p&gt;

    &lt;p&gt;“Work” shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).&lt;/p&gt;

    &lt;p&gt;“Derivative Works” shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.&lt;/p&gt;

    &lt;p&gt;“Contribution” shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, “submitted”
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as “Not a Contribution.”&lt;/p&gt;

    &lt;p&gt;“Contributor” shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Grant of Patent License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:&lt;/p&gt;

    &lt;p&gt;(a) You must give any other recipients of the Work or
    Derivative Works a copy of this License; and&lt;/p&gt;

    &lt;p&gt;(b) You must cause any modified files to carry prominent notices
    stating that You changed the files; and&lt;/p&gt;

    &lt;p&gt;(c) You must retain, in the Source form of any Derivative Works
    that You distribute, all copyright, patent, trademark, and
    attribution notices from the Source form of the Work,
    excluding those notices that do not pertain to any part of
    the Derivative Works; and&lt;/p&gt;

    &lt;p&gt;(d) If the Work includes a “NOTICE” text file as part of its
    distribution, then any Derivative Works that You distribute must
    include a readable copy of the attribution notices contained
    within such NOTICE file, excluding those notices that do not
    pertain to any part of the Derivative Works, in at least one
    of the following places: within a NOTICE text file distributed
    as part of the Derivative Works; within the Source form or
    documentation, if provided along with the Derivative Works; or,
    within a display generated by the Derivative Works, if and
    wherever such third-party notices normally appear. The contents
    of the NOTICE file are for informational purposes only and
    do not modify the License. You may add Your own attribution
    notices within Derivative Works that You distribute, alongside
    or as an addendum to the NOTICE text from the Work, provided
    that such additional attribution notices cannot be construed
    as modifying the License.&lt;/p&gt;

    &lt;p&gt;You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
work stoppage, computer failure or malfunction, or any and all
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;END OF TERMS AND CONDITIONS&lt;/p&gt;

&lt;p&gt;APPENDIX: How to apply the Apache License to your work.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  To apply the Apache License to your work, attach the following
  boilerplate notice, with the fields enclosed by brackets &quot;{}&quot;
  replaced with your own identifying information. (Don't include
  the brackets!)  The text should be enclosed in the appropriate
  comment syntax for the file format. We also recommend that a
  file or class name and description of purpose be included on the
  same &quot;printed page&quot; as the copyright notice for easier
  identification within third-party archives.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Copyright {yyyy} {name of copyright owner}&lt;/p&gt;

&lt;p&gt;Licensed under the Apache License, Version 2.0 (the “License”);
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   http://www.apache.org/licenses/LICENSE-2.0
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an “AS IS” BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.&lt;/p&gt;
</description>
        <pubDate>Tue, 26 Sep 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/09/Apache_License_Version_2.0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/Apache_License_Version_2.0/</guid>
        
        <category>License</category>
        
        
      </item>
    
      <item>
        <title>Mac安装Gitbook并导出电子书</title>
        <description>&lt;p&gt;安装Gitbook并导出电子书&lt;/p&gt;

&lt;h3 id=&quot;安装gitbook客户端&quot;&gt;安装Gitbook客户端&lt;/h3&gt;

&lt;p&gt;输入如下命令进行安装，一定要用到-g，这个代表全局安装&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo npm install gitbook-cli -g
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;在终端输入如下命令即可查看当前Gitbook版本，出现版本信息代表安装成功。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gitbook -V
CLI version: 2.3.2
GitBook version: 3.2.3
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;安装gitbook编辑器&quot;&gt;安装Gitbook编辑器&lt;/h3&gt;

&lt;p&gt;终端环境下的Gitbook只是为了生成HTML文档与电子书使用的，为了方便进行文章书写建议安装Gitbook编辑器。&lt;/p&gt;

&lt;p&gt;下载地址：&lt;a href=&quot;https://www.gitbook.com/editor/&quot;&gt;GitBook Editor&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;安装了Gitbook桌面端之后，你可以在客户端看见gitbook上已有的书籍，也可进行新建一本书籍。创建书籍一般在~/GitBook/Library/目录下&lt;/p&gt;

&lt;h3 id=&quot;创建电子书&quot;&gt;创建电子书&lt;/h3&gt;

&lt;p&gt;有了书籍后，在对应电子书目录，通过如下命令生成HTML&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gitbook build
info: 7 plugins are installed
info: 6 explicitly listed
info: loading plugin &quot;highlight&quot;... OK
info: loading plugin &quot;search&quot;... OK
info: loading plugin &quot;lunr&quot;... OK
info: loading plugin &quot;sharing&quot;... OK
info: loading plugin &quot;fontsettings&quot;... OK
info: loading plugin &quot;theme-default&quot;... OK
info: found 13 pages
info: found 1 asset files
info: &amp;gt;&amp;gt; generation finished with success in 3.1s !
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;看到success的提示表示成功，这个时候对应电子书目录下就生成了一个_book的文件夹。打开就是该书籍的HTML格式了。&lt;/p&gt;

&lt;p&gt;通过如下命令启动服务，就可以在本地浏览了&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gitbook serve
Live reload server started on port: 35729
Press CTRL+C to quit ...

info: 7 plugins are installed
info: loading plugin &quot;livereload&quot;... OK
info: loading plugin &quot;highlight&quot;... OK
info: loading plugin &quot;search&quot;... OK
info: loading plugin &quot;lunr&quot;... OK
info: loading plugin &quot;sharing&quot;... OK
info: loading plugin &quot;fontsettings&quot;... OK
info: loading plugin &quot;theme-default&quot;... OK
info: found 13 pages
info: found 1 asset files
info: &amp;gt;&amp;gt; generation finished with success in 3.3s !

Starting server ...
Serving book on http://localhost:4000
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;看到Serving book on http://localhost:4000，这个时候就可以在浏览器中输入http://localhost:4000进行查看电子书了。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;如果愿意将文档公开到gitbook，可通过Gitbook编辑器提交到gitbook服务器，Gitbook网站上可以直接导出PDF，MOBI，EBUP等电子书格式。
如果不愿意将文档公开，可以不提交然后在本地生成电子书，方法如下。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;本地生成电子书&quot;&gt;本地生成电子书&lt;/h3&gt;

&lt;p&gt;首先需要安装ebook-convert插件，下载&lt;a href=&quot;https://calibre-ebook.com/download&quot;&gt;calibre&lt;/a&gt;并安装.&lt;/p&gt;

&lt;p&gt;安装好后执行如下命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo ln -s /Applications/calibre.app/Contents/MacOS/ebook-convert /usr/local/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;插件安装并配置完成，接下来生成电子书，执行如下命令&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gitbook pdf . ename.pdf
info: 7 plugins are installed
info: 6 explicitly listed
info: loading plugin &quot;highlight&quot;... OK
info: loading plugin &quot;search&quot;... OK
info: loading plugin &quot;lunr&quot;... OK
info: loading plugin &quot;sharing&quot;... OK
info: loading plugin &quot;fontsettings&quot;... OK
info: loading plugin &quot;theme-default&quot;... OK
info: found 13 pages
info: found 1 asset files
info: &amp;gt;&amp;gt; generation finished with success in 6.6s !
info: &amp;gt;&amp;gt; 1 file(s) generated

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;执行完以上代码，进入书籍目录，即可看到已经转换完成的pdf文件了。
同理将&lt;code class=&quot;highlighter-rouge&quot;&gt;gitbook pdf . ename.pdf&lt;/code&gt;改为&lt;code class=&quot;highlighter-rouge&quot;&gt;gitbook mobi . ename.mobi&lt;/code&gt;即可生成mobi文件。&lt;/p&gt;

&lt;h3 id=&quot;设置封面&quot;&gt;设置封面&lt;/h3&gt;

&lt;p&gt;封面用于所有电子书格式，只需两张图片，将其命名为 cover.jpg和cover_small.jpg 并放在对应电子书的根目录下即可。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;好的封面应该遵守以下准则:
cover.jpg 的尺寸为 1800x2360 像素，cover_small.jpg 为 200x262
没有边界
清晰可见的书名
任何重要的文字应该在小版本中可见&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;https://github.com/progit/progit
https://github.com/progit/progit2&lt;/p&gt;

</description>
        <pubDate>Fri, 22 Sep 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/09/gitbook/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/gitbook/</guid>
        
        <category>gitbook</category>
        
        
      </item>
    
  </channel>
</rss>
